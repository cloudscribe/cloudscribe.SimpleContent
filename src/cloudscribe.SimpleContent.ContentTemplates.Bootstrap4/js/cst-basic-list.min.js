function ListItem(e,n,t,o,r,l,i){var s=this
s.Title=ko.observable(decodeEncodedJson(e)),s.Description=ko.observable(decodeEncodedJson(n)),s.FullSizeUrl=ko.observable(t),s.ResizedUrl=ko.observable(o),s.ThumbnailUrl=ko.observable(r),s.LinkUrl=ko.observable(l),s.Sort=ko.observable(i),s.incrementSort=function(){s.Sort(s.Sort()+3)},s.decrementSort=function(){var e=s.Sort()-3
0>e&&(e=0),s.Sort(e)}}function ItemListViewModel(e){var n=this
n.hiddenField=document.getElementById("ItemsJson"),n.handleSortItemChanged=function(e){n.sortItems()
var t=1
for(i=0;i<n.Items().length;i++){var o=n.Items()[i]
o.Sort.silentUpdate(t),t+=2}n.sortItems()},n.Items=ko.observableArray(ko.utils.arrayMap(e,function(e){var e=new ListItem(e.Title,e.Description,e.FullSizeUrl,e.ResizedUrl,e.ThumbnailUrl,e.LinkUrl,e.Sort)
return e.Sort.subscribe(n.handleSortItemChanged),e})),n.addItem=function(e,t,o,r,l,i,s){var a=new ListItem(e,t,o,r,l,i,s)
a.Sort.subscribe(n.handleSortItemChanged),n.Items.push(a),window.thisPage=window.thisPage||{},window.thisPage.hasUnsavedChanges=!0},n.newItemTitle=ko.observable(null),n.newItemDescription=ko.observable(null),n.newItemFullSizeUrl=ko.observable(null),n.newItemResizedUrl=ko.observable(null),n.newItemThumbnailUrl=ko.observable(null),n.newItemLinkUrl=ko.observable(null),n.newItemSort=function(){if(0===n.Items().length)return 1
var e=Math.max.apply(Math,n.Items().map(function(e){return e.Sort()}))
return e+2},n.addNewItem=function(){console.log(n.newItemSort()),n.addItem(n.newItemTitle(),n.newItemDescription(),n.newItemFullSizeUrl(),n.newItemResizedUrl(),n.newItemThumbnailUrl(),n.newItemLinkUrl(),n.newItemSort()),n.newItemTitle(null),n.newItemDescription(null),n.newItemFullSizeUrl(null),n.newItemResizedUrl(null),n.newItemThumbnailUrl(null),n.newItemLinkUrl(null),window.cloudscribeDropAndCrop.clearAllItems()},n.removeItem=function(e){n.Items.remove(e),window.thisPage=window.thisPage||{},window.thisPage.hasUnsavedChanges=!0},n.getCssClass=function(e){return 0===e?"carousel-item active":"carousel-item"},n.dropZoneSuccess=function(e,t){n.newItemFullSizeUrl(t[0].originalUrl),n.newItemResizedUrl(t[0].resizedUrl),n.newItemThumbnailUrl(t[0].thumbUrl)},window.DropZoneSuccessHandler=n.dropZoneSuccess,n.handleCropSave=function(e){n.newItemResizedUrl(e)},window.HandleCropResult=n.handleCropSave,n.serverFileSelected=function(e){n.newItemResizedUrl(e)},window.ServerFileSelected=n.serverFileSelected,n.currentListState=ko.computed(function(){return encodeURIComponent(ko.toJSON(n.Items))}),n.sortItems=function(){n.Items.sort(function(e,n){return e.Sort()<n.Sort()?-1:e.Sort()>n.Sort()?1:0})}}function decodeEncodedJson(e){if(null===e)return e
if(void 0===e)return e
var n=e.replace(/\+/g," ")
return decodeURIComponent(n)}ko.observable.fn.silentUpdate=function(e){this.notifySubscribers=function(){},this(e),this.notifySubscribers=function(){ko.subscribable.fn.notifySubscribers.apply(this,arguments)}},document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("ItemsConfig"),n=JSON.parse(decodeEncodedJson(e.value))
ko.applyBindings(new ItemListViewModel(n))})
